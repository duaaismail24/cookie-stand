var userLats=[]
var userLongs=[]
var smallest=[];var firstAllLocationsVisit=true;var theMap;var locationsArray=[];function panToLocation(location){theMap.panTo(location);}
function adjustOverviewLeft(){if($('body').hasClass("seafood-bars-menus")){return}else{setTimeout(function(){if($('.overview_right').height()){if($('.overview_left').height()<$('.overview_right').height()+30){$('.overview_left').css('height',$('.overview_right').height()+30);}else if($('.overview_left').height()>$('.overview_right').height()+30){$('.overview_right').css('height',$('.overview_left').height()-30);}}else{$('.overview_left').css('height',$('.overview_container').height()-102);}},1000);}}
function readMore(){$('.bio_short').hide();$('.bio_full').show();$('.read_more').hide();adjustOverviewLeft();}
function switchTRP(section){$('.tv_radio_print').addClass('hidden');$('.tv_radio_print.'+section).removeClass('hidden');$("#jquery_jplayer_1").jPlayer({ready:function(){$(this).jPlayer("setMedia",{m4a:"/images/audio/"+$('a.radio_file.active').attr('rel')});},swfPath:"/js/jQuery.jPlayer.2.4.0",supplied:"m4a, oga, mp3, wav",});$('.jp-title ul li').html($('a.radio_file.active').parent().children('div').html());}
function loadYoutubeVideo(This,youtube_id){$('.overlay').addClass('active');$(This).removeClass('active');$('#tv_radio_print_video').attr('src','https://www.youtube.com/embed/'+youtube_id+'?rel=0&autoplay=1');}
function gotoTVSet(This,set){if($(This).prop('tagName')=='LI'){var navSel=$(This).parent().parent().parent().parent();}else{var navSel=$(This).parent().parent().parent();}
if(navSel.children('ul.thumbs_'+set).length!=0){var nextSet=set+1;var prevSet=set-1;navSel.children('ul.video_nav').children('li.bullets_container').children('ul.bullets').children('li').removeClass('active');navSel.children('ul.video_nav').children('li.bullets_container').children('ul.bullets').children('li.bullet_'+set).addClass('active');navSel.children('ul.thumbs').html(navSel.children('ul.thumbs_'+set).html());navSel.children('ul.video_nav').children('li.next').children('a').attr('onclick','gotoTVSet(this,'+nextSet+');return false;');navSel.children('ul.video_nav').children('li.previous').children('a').attr('onclick','gotoTVSet(this,'+prevSet+');return false;');}
return false;}
function switchAudio(audio){$('a.radio_file').removeClass('active');$(audio).addClass('active');$("#jquery_jplayer_1").jPlayer("setMedia",{m4a:"/images/audio/"+$(audio).attr('rel')}).jPlayer("play");$('.jp-title ul li').html($(audio).parent().children('div').html());}
function codeAddresses(address){var address=markers[i][0];var title=markers[i][1];geocoder.geocode({'address':address},function(results){var marker=new google.maps.Marker({position:results[0].geometry.location,address:address,map:map,title:title})
var centered=new google.maps.LatLng(userLats[0],userLongs[0])
var dist=google.maps.geometry.spherical.computeDistanceBetween(centered,marker.position)
var distInMiles=dist/1000*.621;var allDistances=[distInMiles,marker.title,marker.address,marker.position];smallest.push(allDistances);})}
function initializePosition(){setTimeout(function(){var mapOptions={center:new google.maps.LatLng(userLats[0],userLongs[0]),zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false,draggable:false};var map=document.getElementById("map_canvas")?new google.maps.Map(document.getElementById("map_canvas"),mapOptions):{};var markers=[["100 Mill Avenue South Renton 98057","Renton Library","425-226-6043","10am - 9pm","10am - 6pm","10am - 5pm","1pm - 5pm","footerGirl.jpg","2"],["142 Boardwalk Ave Port Townsend 98368","PT Library"],["18322 153rd PL SE Renton 98058","Home Library"]];var geocoder=new google.maps.Geocoder();},100)}
function showPosition(position){var userLat=position.coords.latitude;var userLong=position.coords.longitude;userLats.length=0;userLongs.length=0;userLats.push(userLat);userLongs.push(userLong)}
function getCurrentPosition(){navigator.geolocation.getCurrentPosition(showPosition)}
function initializeNearestLocation(lat,long){getCurrentPosition();google.maps.event.addDomListener(window,'load',initializePosition);var timeOut=500;if(typeof userLats[0]=="undefined"){timeOut=5000;}
setTimeout(function(){if(lat){console.log(lat)
userLats[0]=lat;userLongs[0]=long;}
var arr=JSON.parse(ivarsLocations);$.each(arr.locations,function(key,val){var diffLat=eval(val.lat-userLats[0]);var diffLong=eval(val.long-userLongs[0]);diffLat=diffLat*diffLat;diffLong=diffLong*diffLong;var diffDist=diffLong+diffLat;diffDist=Math.sqrt(diffDist);val.dist=diffDist;});[].sort.call(arr.locations,function(a,b){return a.dist-b.dist;});$('.nearest_location_container h2').html();$('.nearest_location_container div.lft').html('<div class="bold">'+arr.locations[0].name+'</div><div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress"><span itemprop="streetAddress">'+arr.locations[0].address+'</span><br /><span itemprop="addressLocality">'+arr.locations[0].city+'</span>, <span itemprop="addressRegion">'+arr.locations[0].state+'</span> '+arr.locations[0].zip+'</div>');$('.hours_directions.seafoodbars p').html('<br /><b>hours</b><br />'+arr.locations[0].hours[0].set[0].days+'<br />'+arr.locations[0].hours[0].set[0].hours+'<br /><br />'+arr.locations[0].hours[0].set[1].days+'<br />'+arr.locations[0].hours[0].set[1].hours);if($('.map_filter select option').size()<=2){$.each(arr.locations,function(key,val){$('.map_filter select').append('<option>'+val.city+'</option>');});}
var cnt=1;$('.location_item_container').html('');var mapCenter=new google.maps.LatLng(arr.locations[0].lat,arr.locations[0].long);$('.nearest_location_container div.nearestButtons div a:first').attr('href','http://maps.google.com/?q='+arr.locations[0].address+','+arr.locations[0].city+' '+arr.locations[0].state);var myMapOptions={zoom:15,center:mapCenter,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false,draggable:false};var theMap=new google.maps.Map(document.getElementById("map_canvas_nearest"),myMapOptions);for(i=0;i<arr.locations.length;i++){var pin=i+1;marker=new google.maps.Marker({map:theMap,position:new google.maps.LatLng(arr.locations[i].lat,arr.locations[i].long),visible:true,icon:'https://www.ivars.com/images/locations/pin_'+pin+'.png',testing:'this'+i,html:'<div class="boxText" style="font-family: \'palatino linotype\';padding: 20px;"><h4 style="font-size: 14px;font-weight: bold;">'+arr.locations[i].name+'</h4>'+arr.locations[i].address+'<br /><span style="color:#b22630">'+arr.locations[i].phone+'</span><br /><br /><br /><a href="https://maps.google.com/?q='+arr.locations[i].address+', '+arr.locations[i].state+'" target="_blank">Get Directions</a></div>'});google.maps.event.addListener(marker,"click",function(e){myOptions={content:this.html,disableAutoPan:false,maxWidth:0,pixelOffset:new google.maps.Size(0,-20),zIndex:null,boxStyle:{background:"#FFF",opacity:0.9,width:"200px",height:"160px"},closeBoxMargin:"2px 2px 2px 2px",closeBoxURL:"http://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};console.log(myOptions);ib=new InfoBox(myOptions);$('#map_canvas_nearest .boxText').parent().hide();ib.open(theMap,this);});}
var styles=[{stylers:[{hue:"#000"},{saturation:-200}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:'#ffffff'},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]}];theMap.setOptions({styles:styles});google.maps.event.addListener(theMap,'click',function(event){console.log(event.latLng.lat()+','+event.latLng.lng());});},timeOut);}
function initializeSeafoodBars(lat,long,view){getCurrentPosition();google.maps.event.addDomListener(window,'load',initializePosition);var timeOut=500;if(typeof userLats[0]=="undefined"){timeOut=10000;}
setTimeout(function(){if(lat){console.log(lat)
userLats[0]=lat;userLongs[0]=long;}
else{if($('.map_filter .city_zip').val()!="Enter City or Zip"){userLats[0]=$('.hidden.lat').text();userLongs[0]=$('.hidden.long').text();}
else{console.log("user lats creation")
userLats[0]=47.6097;userLongs[0]=-122.3331;}}
var arr=JSON.parse(seafoodBars);if(typeof arr.locations==='object'){var locales=[];$.each(arr.locations,function(k,v){locales.push(v);});arr.locations=locales;}
$.each(arr.locations,function(key,val){var diffLat=eval(val.lat-userLats[0]);var diffLong=eval(val.long-userLongs[0]);diffLat=diffLat*diffLat;diffLong=diffLong*diffLong;var diffDist=diffLong+diffLat;diffDist=Math.sqrt(diffDist);val.dist=diffDist;});[].sort.call(arr.locations,function(a,b){return a.dist-b.dist;});$('.parking.seafoodbars h4').html(arr.locations[0].name);$('.parking.seafoodbars p').html(arr.locations[0].address+'<br /> '+arr.locations[0].city+','+arr.locations[0].state+' '+arr.locations[0].zip);$('.hours_directions.seafoodbars p').html('<br /><b>hours</b><br />'+arr.locations[0].hours[0].set[0].days+'<br />'+arr.locations[0].hours[0].set[0].hours+'<br /><br />'+arr.locations[0].hours[0].set[1].days+'<br />'+arr.locations[0].hours[0].set[1].hours);var allCities='';if($('.map_filter div.selectWrapper select option').size()<=3){if(firstAllLocationsVisit){if(window.location.href.indexOf("all-locations")>-1){[].sort.call(arr.locations,(sortBy("city")));$('select option:contains("Seattle")').empty();$('select option:contains("City")').text("Seattle");allCities+="Seattle ";}
else{[].sort.call(arr.locations,(sortBy("city")));}
$('div.selectWrapper select').val("Seattle");firstAllLocationsVisit=false;}
$.each(arr.locations,function(key,val){if(allCities.indexOf(val.city)==-1){$('.map_filter div.selectWrapper select').append('<option>'+val.city+'</option>');}
allCities+=' '+val.city;});[].sort.call(arr.locations,function(a,b){return a.dist-b.dist;});}
[].sort.call(arr.locations,function(a,b){return a.dist-b.dist;});var cnt=1;$('.location_item_container').html('');var mapCenter=new google.maps.LatLng(arr.locations[0].lat,arr.locations[0].long);var myMapOptions={zoom:15,center:mapCenter,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false,draggable:false};theMap=new google.maps.Map($("#map-canvas."+view)[0],myMapOptions);var menuLinks={};menuLinks["Acres Of Clams"]="/locations/acres-of-clams/acres-of-clams-menus";menuLinks["Acres Of Clams (Temporarily Closed)"]="/locations/acres-of-clams-menus";menuLinks["Salmon House"]="/locations/salmon-house/salmon-house-menus";menuLinks["Mukilteo Landing"]="/locations/mukilteo-landing/mukilteo-landing-menus";menuLinks["Fish Bar (Seattle Waterfront)"]="/locations/seafood-bars/seafood-bars-menus#p54-fish-bar";menuLinks["Fish Bar (Lake Union)"]="/locations/seafood-bars/seafood-bars-menus#sh-fish-bar";menuLinks["Fish Bar (Mukilteo)"]="/locations/seafood-bars/seafood-bars-menus#muk-fish-bar";menuLinks["Renton"]="/locations/seafood-bars/seafood-bars-menus#renton-seafood-bar";$.each(arr.locations,function(key,val){var locationCoords=new google.maps.LatLng(val.lat,val.long);var locationObject={};locationObject[val.name]=locationCoords;locationsArray.push(locationObject);if(cnt<=100){var locationItem='<div class="location_item" style="background-image:url(/images/locations/pin_'+cnt+'.png)">';if(menuLinks[val.name]!=undefined){var menuLinkOut=menuLinks[val.name]}else{var menuLinkOut="/locations/seafood-bars/seafood-bars-menus"}
locationItem+='<table>';locationItem+='<tr>';var clickFunction="theMap.panTo(locationCoords)";var locationId="location-"+cnt;var locationIdSymbol="#"+locationId;locationItem+='<td class="title" colspan="3">'+val.name+'</td>';$(locationIdSymbol).click(function(){theMap.panTo(locationCoords);});locationItem+='</tr>';locationItem+='</table>';locationItem+='<div class="locationContainer">';locationItem+='<div class="locationInfo">';locationItem+='<div class="">'+val.address+'</div>'
locationItem+='<div class="">'+val.city+', '+val.state+' '+val.zip+'</div>';locationItem+='<div class=""><a class="linkRed1" href="tel:'+val.phone+'">'+val.phone+'</a></div>';locationItem+='</div>';locationItem+='<div class="locationHours">';locationItem+='<h4>'+val.hours[0].title+'</h4>';locationItem+='<div class="firstHours">'+val.hours[0].set[0].days+'<br />'+val.hours[0].set[0].hours+'</div><br />';locationItem+='<div class="secondHours">'+val.hours[0].set[1].days+'<br />'+val.hours[0].set[1].hours+'</div>';locationItem+='</div>';locationItem+='<div class="locationLinks">';locationItem+='<div class="directionsLink"><a class="linkRed1" href="'+val.mapLink+'" target="_blank">Directions</a></div>';locationItem+='<div class="menusLink"><a  class="linkRed1" href="'+menuLinkOut+'">Menus</a></div>';locationItem+='</div>';locationItem+='<aside class="clr"></aside>';locationItem+='</div>';$('.location_item_container').append(locationItem);cnt++;}});for(i=0;i<arr.locations.length;i++){var pin=i+1;marker=new google.maps.Marker({map:theMap,position:new google.maps.LatLng(arr.locations[i].lat,arr.locations[i].long),visible:true,icon:'https://www.ivars.com/images/locations/pin_'+pin+'.png',testing:'this'+i,html:'<div class="boxText" style="font-family: \'palatino linotype\';padding: 20px;"><h4 style="font-size: 14px;font-weight: bold;">'+arr.locations[i].name+'</h4>'+arr.locations[i].address+'<br /><span style="color:#b22630">'+arr.locations[i].phone+'</span><br /><br /><br /><a href="https://maps.google.com/?q='+arr.locations[i].address+', '+arr.locations[i].state+'" target="_blank">Get Directions</a></div>'});google.maps.event.addListener(marker,"click",function(e){myOptions={content:this.html,disableAutoPan:false,maxWidth:0,pixelOffset:new google.maps.Size(0,-20),zIndex:null,boxStyle:{background:"#FFF",opacity:0.9,width:"200px",height:"160px"},closeBoxMargin:"2px 2px 2px 2px",closeBoxURL:"http://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};ib=new InfoBox(myOptions);$('#map-canvas .boxText').parent().hide();ib.open(theMap,this);});}
var styles=[{stylers:[{hue:"#000"},{saturation:-200}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:'#ffffff'},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]}];theMap.setOptions({styles:styles});google.maps.event.addListener(theMap,'click',function(event){console.log(event.latLng.lat()+','+event.latLng.lng());});adjustOverviewLeft();},timeOut);var test=[];$(document).on('change','.map_filter select',(function(){var geocoder=new google.maps.Geocoder();var submitAddress="";submitAddress=$(this).val()+", WA, USA";var SW=new google.maps.LatLng(45.564833,-124.712402);var NE=new google.maps.LatLng(49.063789,-116.956055);var bounds=new google.maps.LatLngBounds(SW,NE);geocoder.geocode({'address':submitAddress,'bounds':bounds},function(results){var locales=results[0].geometry.location;var locales2=JSON.stringify(locales)
initializeSeafoodBars(results[0].geometry.location.lat(),results[0].geometry.location.lng(),view);})}));$(document).on('click','.map_filter .city_zip',(function(){$(this).val('');}));$(document).on('keyup','.map_filter .city_zip',(function(){if($(this).val().length>4){var geocoder=new google.maps.Geocoder();geocoder.geocode({'address':$(this).val()},function(results){var locales=results[0].geometry.location;var locales2=JSON.stringify(locales)
var localVariables=locales2.replace(/\d+/g,'').split('"')
initializeSeafoodBars(results[0].geometry.location.lat(),results[0].geometry.location.lng(),view);})}}));}
$(document).ready(function(){$('a.locationTitle').on('click',function(){var laLatLng=locationsArray[$(this).data('location')];theMap.panTo(laLatLng);});});function initialize(canvasName,view,locName,locAddr,locCity,locState,locZip,locPhone){var coords=$('li a.directions').attr('rel').split(',');var mapOptions={center:new google.maps.LatLng(coords[0],coords[1]),zoom:17,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false,draggable:false};var map=new google.maps.Map(document.getElementById(canvasName),mapOptions);var myLatlng=new google.maps.LatLng(coords[0],coords[1]);var marker=new google.maps.Marker({position:myLatlng,map:map,icon:'https://www.ivars.com/images/locations/pin_1.png',html:'<div class="boxText" style="font-family: \'palatino linotype\';padding: 20px;"><h4 style="font-size: 14px;font-weight: bold;">'+locName+'</h4>'+locAddr+'<br />'+locCity+', '+locState+' '+locZip+'<br /><span style="color:#b22630">'+locPhone+'</span><br /><br /><br /><a href="https://maps.google.com/?q='+locAddr+', '+locCity+' '+locState+'" target="_blank">Get Directions</a></div>'});google.maps.event.addListener(marker,"click",function(e){myOptions={content:this.html,disableAutoPan:false,maxWidth:0,pixelOffset:new google.maps.Size(0,-20),zIndex:null,boxStyle:{background:"#FFF",opacity:0.9,width:"200px",height:"160px"},closeBoxMargin:"2px 2px 2px 2px",closeBoxURL:"http://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};ib=new InfoBox(myOptions);$('#map-canvas .boxText').parent().hide();ib.open(map,this);});var styles=[{stylers:[{hue:"#000"},{saturation:-200}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:'#ffffff'},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]}];map.setOptions({styles:styles});google.maps.event.addListener(map,'click',function(event){console.log(event.latLng.lat()+','+event.latLng.lng());});}
$(function(){adjustOverviewLeft();$('#tv_radio_print_link').click(function(){$('ul.video_nav li.next a').attr('onclick','gotoTVSet(this,'+$('ul.video_nav li.next a').attr('rel')+');return false;');return false;});$('.overview_left ul li a').click(function(){adjustOverviewLeft();});jQuery('.overview_left ul li a').click(function(){var newActive=jQuery(this).attr('href').replace("#","");jQuery('.contentContainer').addClass('hidden');jQuery('#'+newActive+'.contentContainer').removeClass('hidden');jQuery(this).parent().parent().children('li').removeClass('active');jQuery(this).parent().addClass('active');return false;});jQuery('.directions').click(function(){jQuery('#parking_directions').append('<div id="map-canvas" class="standard"></div>');console.log('test')
initialize('map-canvas','standard',locName,locAddr,locCity,locState,locZip,locPhone);});jQuery('.hours_directions').click(function(){initializeSeafoodBars('','','standard');return false;});$('.seafood_directions').click(function(){initializeSeafoodBars('','','mobile');$('article.content').css('height','1700px');return false;});var This=$('.overview-link a');This.parent().parent().children('li').removeClass('active');This.parent().addClass('active');$('div.mobile_dropdown div.title').click(function(){if($('div.mobile_dropdown ul').css('display')=='none'){$('div.mobile_dropdown ul').slideDown('fast');}else{$('div.mobile_dropdown ul').slideUp('fast');}});$('div.mobile_dropdown ul li a').click(function(){$('div.mobile_dropdown div.title').html($(this).html());$('.overview_content.main').html($($(this).attr('href')).html());if($(this).attr('href')=='#mobile_parking'){$('.overview_content.main').append('<div id="map-canvas" class="mobile"></div>');initialize('map-canvas');}else{$('#map-canvas.standard').remove();}
$('div.mobile_dropdown ul').hide();});if($.browser.msie&&parseInt($.browser.version,10)===8){$('div.bio .read_more a').css('position','absolute');$('div.bio .read_more a').css('margin-top','-15px');}});